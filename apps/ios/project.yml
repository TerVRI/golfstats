name: RoundCaddy
options:
  bundleIdPrefix: com.roundcaddy
  deploymentTarget:
    iOS: "17.0"
    watchOS: "10.0"
  xcodeVersion: "15.0"
  generateEmptyDirectories: true
  groupSortPosition: top
  createIntermediateGroups: true

settings:
  base:
    MARKETING_VERSION: "1.0.0"
    CURRENT_PROJECT_VERSION: "1"
    # Apple Developer Team ID
    DEVELOPMENT_TEAM: "AYEZVE9ZJ6"
    CODE_SIGN_STYLE: Automatic
    SWIFT_VERSION: "5.9"
    # App Store optimization
    ENABLE_BITCODE: false
    DEBUG_INFORMATION_FORMAT: "dwarf-with-dsym"
    # Archive settings
    SKIP_INSTALL: false
    INSTALL_PATH: "$(LOCAL_APPS_DIR)"
  configs:
    Debug:
      DEBUG_INFORMATION_FORMAT: dwarf
    Release:
      DEBUG_INFORMATION_FORMAT: "dwarf-with-dsym"
      SWIFT_OPTIMIZATION_LEVEL: "-O"
      SWIFT_COMPILATION_MODE: wholemodule

targets:
  GolfStats:
    type: application
    platform: iOS
    sources:
      - path: GolfStats/Sources
        type: group
      - path: GolfStats/Resources
        type: group
    settings:
      base:
        INFOPLIST_FILE: GolfStats/Resources/Info.plist
        PRODUCT_BUNDLE_IDENTIFIER: com.roundcaddy.ios
        ASSETCATALOG_COMPILER_APPICON_NAME: AppIcon
        TARGETED_DEVICE_FAMILY: "1,2"
        SUPPORTS_MACCATALYST: false
        ENABLE_PREVIEWS: true
        # App Store requirements
        ALWAYS_EMBED_SWIFT_STANDARD_LIBRARIES: true
    entitlements:
      path: GolfStats/Resources/GolfStats.entitlements
      properties:
        com.apple.developer.applesignin:
          - Default
        com.apple.security.application-groups:
          - group.com.roundcaddy
    preBuildScripts: []
    postBuildScripts: []
    dependencies:
      - target: GolfStatsWatch
        embed: true

  GolfStatsWatch:
    type: application
    platform: watchOS
    sources:
      - path: ../watch/GolfStatsWatch WatchKit Extension/Sources
        type: group
      - path: ../watch/GolfStatsWatch WatchKit Extension/Resources
        type: group
        buildPhase: resources
        excludes:
          - "Info.plist"
          - "*.entitlements"
    settings:
      base:
        INFOPLIST_FILE: ../watch/GolfStatsWatch WatchKit Extension/Resources/Info.plist
        PRODUCT_BUNDLE_IDENTIFIER: com.roundcaddy.ios.watchkitapp
        ASSETCATALOG_COMPILER_APPICON_NAME: AppIcon
        ENABLE_PREVIEWS: true
        SKIP_INSTALL: true
        WATCHOS_DEPLOYMENT_TARGET: "10.0"
        # Watch app embedding
        ALWAYS_EMBED_SWIFT_STANDARD_LIBRARIES: true
        CODE_SIGN_ENTITLEMENTS: ../watch/GolfStatsWatch WatchKit Extension/Resources/GolfStatsWatch.entitlements

schemes:
  GolfStats:
    build:
      targets:
        GolfStats: all
        GolfStatsWatch: all
    run:
      config: Debug
    test:
      config: Debug
    profile:
      config: Release
    analyze:
      config: Debug
    archive:
      config: Release

  GolfStatsWatch:
    build:
      targets:
        GolfStatsWatch: all
    run:
      config: Debug
    test:
      config: Debug
    profile:
      config: Release
    analyze:
      config: Debug
    archive:
      config: Release
