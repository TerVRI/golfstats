module.exports=[42612,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);a.i(58645);var f=a.i(92552),g=a.i(39524),h=a.i(28503),i=a.i(760);a.i(413);var j=a.i(81118),k=a.i(45409),l=a.i(51444),m=a.i(210),n=a.i(32860),o=a.i(33441),p=a.i(13749),q=a.i(50522),r=a.i(94183),s=a.i(50429),t=a.i(96221);function u({params:a}){let u,v,{id:w}=(0,c.use)(a),x=(0,d.useRouter)(),y=(0,l.createClient)(),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)("course"),[H,I]=(0,c.useState)(1),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)([]);(0,c.useEffect)(()=>{!async function(){A(!0);try{let{data:a,error:b}=await y.from("rounds").select("*").eq("id",w).single();if(b)throw b;let{data:c,error:d}=await y.from("hole_scores").select("*").eq("round_id",w).order("hole_number");if(d)throw d;if(K(a.course_name),M(a.course_rating?.toString()||""),O(a.slope_rating?.toString()||""),Q(a.played_at),c&&c.length>0){let a=c.map(a=>({hole_number:a.hole_number,par:a.par,score:a.score,putts:a.putts||2,fairway_hit:a.fairway_hit??!1,gir:a.gir??!1,penalties:a.penalties||0,approach_distance:a.approach_distance,first_putt_distance:a.first_putt_distance,tee_club:null,approach_club:null,approach_result:null}));S(a)}else S(Array.from({length:18},(a,b)=>(0,k.createDefaultHoleData)(b+1,4)))}catch(a){console.error("Error loading round:",a),E("Failed to load round")}finally{A(!1)}}()},[w,y]);let T=(0,c.useCallback)((a,b)=>{S(c=>c.map(c=>c.hole_number===a?{...c,...b}:c))},[]),U=R[H-1],V=()=>{let a=R.reduce((a,b)=>a+b.score,0),b=R.reduce((a,b)=>a+b.par,0),c=R.reduce((a,b)=>a+b.putts,0),d=R.filter(a=>a.par>=4&&a.fairway_hit).length,e=R.filter(a=>a.par>=4).length;return{totalScore:a,totalPar:b,totalPutts:c,fairwaysHit:d,fairwaysTotal:e,girCount:R.filter(a=>a.gir).length,penalties:R.reduce((a,b)=>a+b.penalties,0),scoreToPar:a-b}},W=async()=>{C(!0),E(null);try{let a=(0,j.calculateRoundStrokesGained)(R),b=V(),{error:c}=await y.from("rounds").update({course_name:J,course_rating:L?parseFloat(L):null,slope_rating:N?parseInt(N):null,played_at:P,total_score:b.totalScore,total_putts:b.totalPutts,fairways_hit:b.fairwaysHit,fairways_total:b.fairwaysTotal,gir:b.girCount,penalties:b.penalties,sg_total:a.sg_total,sg_off_tee:a.sg_off_tee,sg_approach:a.sg_approach,sg_around_green:a.sg_around_green,sg_putting:a.sg_putting}).eq("id",w);if(c)throw Error(`Failed to update round: ${c.message}`);await y.from("hole_scores").delete().eq("round_id",w);let d=R.map(a=>({round_id:w,hole_number:a.hole_number,par:a.par,score:a.score,putts:a.putts,fairway_hit:a.par>=4?a.fairway_hit:null,gir:a.gir,penalties:a.penalties,approach_distance:a.approach_distance,first_putt_distance:a.first_putt_distance})),{error:e}=await y.from("hole_scores").insert(d);if(e)throw Error(`Failed to update hole scores: ${e.message}`);x.push(`/rounds/${w}`)}catch(a){console.error("Save error:",a),E(a instanceof Error?a.message:"An unexpected error occurred")}finally{C(!1)}};return z?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(t.Loader2,{className:"w-8 h-8 animate-spin text-accent-green"})}):0===R.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("p",{className:"text-accent-red mb-4",children:D||"Round not found"}),(0,b.jsx)(e.default,{href:"/rounds",children:(0,b.jsx)(g.Button,{children:"Back to Rounds"})})]}):(0,b.jsxs)("div",{className:"min-h-screen",children:[(0,b.jsxs)(e.default,{href:`/rounds/${w}`,className:"inline-flex items-center gap-2 text-foreground-muted hover:text-foreground transition-colors mb-6",children:[(0,b.jsx)(m.ArrowLeft,{className:"w-4 h-4"}),"Cancel Edit"]}),(0,b.jsx)("div",{className:"max-w-xl mx-auto mb-8",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:[{key:"course",label:"Course",icon:r.Flag},{key:"holes",label:"Scorecard",icon:s.Target},{key:"review",label:"Review",icon:o.Check}].map((a,c)=>{let d=a.icon,e=F===a.key,f="holes"===F&&"course"===a.key||"review"===F&&("course"===a.key||"holes"===a.key);return(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsxs)("div",{className:(0,i.cn)("flex items-center gap-2 px-4 py-2 rounded-full transition-colors",e?"bg-accent-green text-white":f?"bg-accent-green/20 text-accent-green":"bg-background-secondary text-foreground-muted"),children:[(0,b.jsx)(d,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-sm font-medium hidden sm:inline",children:a.label})]}),c<2&&(0,b.jsx)("div",{className:(0,i.cn)("w-8 md:w-16 h-0.5 mx-2",f||e?"bg-accent-green":"bg-background-tertiary")})]},a.key)})})}),"course"===F&&(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-6 animate-fade-in",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Edit Course Information"}),(0,b.jsx)("p",{className:"text-foreground-muted mt-1",children:"Update the details about the course"})]}),(0,b.jsx)(h.Input,{label:"Course Name",placeholder:"e.g., Pebble Beach Golf Links",value:J,onChange:a=>K(a.target.value)}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(h.Input,{label:"Course Rating",type:"number",step:"0.1",placeholder:"72.0",value:L,onChange:a=>M(a.target.value)}),(0,b.jsx)(h.Input,{label:"Slope Rating",type:"number",placeholder:"130",value:N,onChange:a=>O(a.target.value)})]}),(0,b.jsx)(h.Input,{label:"Date Played",type:"date",value:P,onChange:a=>Q(a.target.value)}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsxs)(g.Button,{onClick:()=>G("holes"),disabled:!J,className:"w-full",size:"lg",children:["Continue to Scorecard",(0,b.jsx)(n.ArrowRight,{className:"w-5 h-5 ml-2"})]})})]}),"holes"===F&&(0,b.jsxs)("div",{className:"max-w-2xl mx-auto animate-fade-in",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>I(Math.max(1,H-1)),disabled:1===H,children:[(0,b.jsx)(p.ChevronLeft,{className:"w-5 h-5"}),"Prev"]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold text-foreground",children:["Hole ",H]}),(0,b.jsxs)("p",{className:"text-foreground-muted",children:["Par ",U?.par]})]}),(0,b.jsxs)(g.Button,{variant:"ghost",onClick:()=>I(Math.min(18,H+1)),disabled:18===H,children:["Next",(0,b.jsx)(q.ChevronRight,{className:"w-5 h-5"})]})]}),(0,b.jsx)("div",{className:"flex gap-1 mb-8 overflow-x-auto pb-2",children:R.map(a=>(0,b.jsx)("button",{onClick:()=>I(a.hole_number),className:(0,i.cn)("w-8 h-8 rounded-lg text-sm font-medium transition-colors flex-shrink-0",H===a.hole_number?"bg-accent-green text-white":a.score>0?"bg-background-tertiary text-foreground":"bg-background-secondary text-foreground-muted"),children:a.hole_number},a.hole_number))}),U&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Card,{className:"mb-6",children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground-muted mb-2",children:"Par"}),(0,b.jsx)("div",{className:"flex gap-2",children:[3,4,5].map(a=>(0,b.jsx)("button",{onClick:()=>T(H,{par:a}),className:(0,i.cn)("flex-1 py-2 rounded-lg font-medium transition-colors",U.par===a?"bg-accent-green text-white":"bg-background-secondary text-foreground-muted hover:bg-background-tertiary"),children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground-muted mb-2",children:"Score"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>T(H,{score:Math.max(1,U.score-1)}),className:"w-10 h-10 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors text-lg font-medium",children:"-"}),(0,b.jsx)("span",{className:(0,i.cn)("text-2xl font-bold w-10 text-center",(0,i.getScoreColor)(U.score,U.par)),children:U.score}),(0,b.jsx)("button",{onClick:()=>T(H,{score:U.score+1}),className:"w-10 h-10 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors text-lg font-medium",children:"+"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground-muted mb-2",children:"Putts"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>T(H,{putts:Math.max(0,U.putts-1)}),className:"w-10 h-10 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors text-lg font-medium",children:"-"}),(0,b.jsx)("span",{className:"text-2xl font-bold w-10 text-center text-foreground",children:U.putts}),(0,b.jsx)("button",{onClick:()=>T(H,{putts:U.putts+1}),className:"w-10 h-10 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors text-lg font-medium",children:"+"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground-muted mb-2",children:"Penalties"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>T(H,{penalties:Math.max(0,U.penalties-1)}),className:"w-10 h-10 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors text-lg font-medium",children:"-"}),(0,b.jsx)("span",{className:"text-2xl font-bold w-10 text-center text-accent-red",children:U.penalties}),(0,b.jsx)("button",{onClick:()=>T(H,{penalties:U.penalties+1}),className:"w-10 h-10 rounded-lg bg-background-secondary hover:bg-background-tertiary transition-colors text-lg font-medium",children:"+"})]})]})]})})}),(0,b.jsx)(f.Card,{className:"mb-6",children:(0,b.jsx)(f.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[U.par>=4&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground-muted mb-2",children:"Fairway Hit"}),(0,b.jsx)("div",{className:"flex gap-2",children:[{value:!0,label:"Yes"},{value:!1,label:"No"}].map(a=>(0,b.jsx)("button",{onClick:()=>T(H,{fairway_hit:a.value}),className:(0,i.cn)("flex-1 py-2 rounded-lg font-medium transition-colors",U.fairway_hit===a.value?a.value?"bg-accent-green text-white":"bg-accent-red text-white":"bg-background-secondary text-foreground-muted hover:bg-background-tertiary"),children:a.label},String(a.value)))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-foreground-muted mb-2",children:"Green in Regulation"}),(0,b.jsx)("div",{className:"flex gap-2",children:[{value:!0,label:"Yes"},{value:!1,label:"No"}].map(a=>(0,b.jsx)("button",{onClick:()=>T(H,{gir:a.value}),className:(0,i.cn)("flex-1 py-2 rounded-lg font-medium transition-colors",U.gir===a.value?a.value?"bg-accent-green text-white":"bg-accent-red text-white":"bg-background-secondary text-foreground-muted hover:bg-background-tertiary"),children:a.label},String(a.value)))})]})]})})})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsxs)(g.Button,{variant:"secondary",onClick:()=>G("course"),className:"flex-1",children:[(0,b.jsx)(m.ArrowLeft,{className:"w-5 h-5 mr-2"}),"Back to Course"]}),(0,b.jsxs)(g.Button,{onClick:()=>G("review"),className:"flex-1",children:["Review Round",(0,b.jsx)(n.ArrowRight,{className:"w-5 h-5 ml-2"})]})]})]}),"review"===F&&(u=V(),v=(0,j.calculateRoundStrokesGained)(R),(0,b.jsxs)("div",{className:"max-w-3xl mx-auto animate-fade-in",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Review Changes"}),(0,b.jsxs)("p",{className:"text-foreground-muted mt-1",children:[J," - ",P]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,b.jsx)("p",{className:"text-sm text-foreground-muted mb-1",children:"Score"}),(0,b.jsx)("p",{className:(0,i.cn)("text-3xl font-bold",(0,i.getScoreColor)(u.totalScore,u.totalPar)),children:u.totalScore}),(0,b.jsxs)("p",{className:"text-xs text-foreground-muted",children:[u.scoreToPar>=0?"+":"",u.scoreToPar," to par"]})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,b.jsx)("p",{className:"text-sm text-foreground-muted mb-1",children:"Total Putts"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-foreground",children:u.totalPutts}),(0,b.jsxs)("p",{className:"text-xs text-foreground-muted",children:[(u.totalPutts/18).toFixed(1)," per hole"]})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,b.jsx)("p",{className:"text-sm text-foreground-muted mb-1",children:"Fairways"}),(0,b.jsxs)("p",{className:"text-3xl font-bold text-foreground",children:[u.fairwaysHit,"/",u.fairwaysTotal]}),(0,b.jsxs)("p",{className:"text-xs text-foreground-muted",children:[(u.fairwaysHit/u.fairwaysTotal*100).toFixed(0),"%"]})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,b.jsx)("p",{className:"text-sm text-foreground-muted mb-1",children:"GIR"}),(0,b.jsxs)("p",{className:"text-3xl font-bold text-foreground",children:[u.girCount,"/18"]}),(0,b.jsxs)("p",{className:"text-xs text-foreground-muted",children:[(u.girCount/18*100).toFixed(0),"%"]})]})})]}),(0,b.jsxs)(f.Card,{className:"mb-8",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Target,{className:"w-5 h-5 text-accent-green"}),"Strokes Gained Analysis"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,b.jsxs)("div",{className:"text-center p-3 rounded-lg bg-background-secondary",children:[(0,b.jsx)("p",{className:"text-xs text-foreground-muted mb-1",children:"Total"}),(0,b.jsxs)("p",{className:(0,i.cn)("text-xl font-bold",v.sg_total>=0?"text-accent-green":"text-accent-red"),children:[v.sg_total>=0?"+":"",v.sg_total.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"text-center p-3 rounded-lg bg-background-secondary",children:[(0,b.jsx)("p",{className:"text-xs text-foreground-muted mb-1",children:"Off Tee"}),(0,b.jsxs)("p",{className:(0,i.cn)("text-xl font-bold",v.sg_off_tee>=0?"text-accent-green":"text-accent-red"),children:[v.sg_off_tee>=0?"+":"",v.sg_off_tee.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"text-center p-3 rounded-lg bg-background-secondary",children:[(0,b.jsx)("p",{className:"text-xs text-foreground-muted mb-1",children:"Approach"}),(0,b.jsxs)("p",{className:(0,i.cn)("text-xl font-bold",v.sg_approach>=0?"text-accent-green":"text-accent-red"),children:[v.sg_approach>=0?"+":"",v.sg_approach.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"text-center p-3 rounded-lg bg-background-secondary",children:[(0,b.jsx)("p",{className:"text-xs text-foreground-muted mb-1",children:"Around Green"}),(0,b.jsxs)("p",{className:(0,i.cn)("text-xl font-bold",v.sg_around_green>=0?"text-accent-green":"text-accent-red"),children:[v.sg_around_green>=0?"+":"",v.sg_around_green.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"text-center p-3 rounded-lg bg-background-secondary",children:[(0,b.jsx)("p",{className:"text-xs text-foreground-muted mb-1",children:"Putting"}),(0,b.jsxs)("p",{className:(0,i.cn)("text-xl font-bold",v.sg_putting>=0?"text-accent-green":"text-accent-red"),children:[v.sg_putting>=0?"+":"",v.sg_putting.toFixed(2)]})]})]})})]}),D&&(0,b.jsx)("div",{className:"mb-4 p-4 rounded-lg bg-accent-red/10 border border-accent-red/20 text-accent-red",children:D}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsxs)(g.Button,{variant:"secondary",onClick:()=>G("holes"),className:"flex-1",disabled:B,children:[(0,b.jsx)(m.ArrowLeft,{className:"w-5 h-5 mr-2"}),"Edit Scores"]}),(0,b.jsx)(g.Button,{onClick:W,className:"flex-1",disabled:B,children:B?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),"Saving..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Check,{className:"w-5 h-5 mr-2"}),"Save Changes"]})})]})]}))]})}a.s(["default",()=>u])}];

//# sourceMappingURL=apps_web_src_app_%28app%29_rounds_%5Bid%5D_edit_page_tsx_5d5da4fe._.js.map